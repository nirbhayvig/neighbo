---
paths: apps/web/src/**
---

# Frontend Rules — `apps/web`

Rules for the React 19 + TanStack Router + Capacitor web/mobile frontend.

## shadcn/ui — MANDATORY

<required>
ALWAYS use shadcn/ui components from `apps/web/src/components/ui/` before writing any custom UI. Do not build buttons, inputs, dialogs, cards, badges, or other primitives from scratch when a shadcn component exists.
</required>

### Available Components

**Layout:** `accordion`, `card`, `collapsible`, `separator`, `tabs`, `sidebar`, `resizable`

**Navigation:** `breadcrumb`, `navigation-menu`, `menubar`, `pagination`

**Forms:** `button`, `button-group`, `checkbox`, `input`, `input-group`, `input-otp`, `label`, `native-select`, `radio-group`, `select`, `slider`, `switch`, `textarea`, `form`, `field`, `item`, `combobox`

**Overlays:** `alert`, `alert-dialog`, `dialog`, `drawer`, `popover`, `sheet`, `tooltip`, `hover-card`, `context-menu`, `dropdown-menu`, `command`

**Feedback:** `progress`, `skeleton`, `spinner`, `sonner` (toasts)

**Data display:** `table`, `calendar`, `chart`, `carousel`, `avatar`, `badge`, `empty`, `aspect-ratio`

**Utilities:** `scroll-area`, `direction`, `kbd`

### Adding a New Component
If a needed component is not in the list above, add it via the CLI — do NOT build from scratch:
```bash
cd apps/web
bunx --bun shadcn@latest add <component-name>
```

<forbidden>
- Edit files in `apps/web/src/components/ui/` — they are generated by shadcn CLI
- Build primitive UI elements (buttons, inputs, badges, dialogs) that shadcn already provides
- Use raw HTML elements where a shadcn component exists (e.g., `<button>` instead of `<Button>`)
</forbidden>

## Backend-Frontend Interaction

The frontend communicates with `apps/api` exclusively via the **Hono RPC client** — never raw `fetch` or Axios.

### How It Works
1. The API exports its full type as `AppType` from `apps/api/src/app.ts`
2. The web app imports `AppType` via the `@neighbo/api` path alias (see `tsconfig.json`)
3. The client at `@/lib/api.ts` instantiates `hc<AppType>` with auto Bearer token injection
4. Vite dev proxy forwards `/api/*` → `http://localhost:3001` (see `vite.config.ts`)

<examples>
<good>
```typescript
// Correct — use the typed RPC client from @/lib/api
import { api } from "@/lib/api"
const res = await api.health.$get()
```
</good>
<bad>
```typescript
// Wrong — do not bypass the RPC client
const res = await fetch("/api/health")
```
</bad>
</examples>

### Adding New API Calls
- Add the route in `apps/api/src/` — `AppType` updates automatically
- Call it via `api.<route>.$get()` / `.$post()` etc. — fully type-safe
- Wrap calls in TanStack Query (`useQuery` / `useMutation`) for caching and loading states

## Routing

- File-based routing via TanStack Router in `apps/web/src/routes/`
- Route tree is auto-generated in `routeTree.gen.ts` — **do not edit**
- Protected pages live under `_authenticated/` — the layout guard at `_authenticated.tsx` handles redirect
- New routes: create a file in `routes/` and let the router plugin auto-generate the tree

## State Management

- **Server state:** TanStack React Query (`useQuery`, `useMutation`, `useQueryClient`)
- **Auth state:** Firebase Auth via `@/lib/auth.ts` — `onAuthChange`, `signInWithGoogle`, `signOut`
- No Redux/Zustand — prefer colocated React state or Query for everything

## Path Aliases

| Alias | Resolves to |
|-------|-------------|
| `@/` | `apps/web/src/` |
| `@neighbo/shared` | `packages/shared/src/` |
| `@neighbo/api` | `apps/api/src/app.ts` |

## Capacitor / Native

- Auth uses Capacitor Firebase plugin on native (handled in `@/lib/auth.ts` — platform-aware)
- Firebase persistence is Capacitor-aware (`@/lib/firebase.ts`)
- Capacitor config: `apps/web/capacitor.config.ts` (App ID: `com.neighbo.app`)

## Reference Files
- API client: `apps/web/src/lib/api.ts`
- Auth helpers: `apps/web/src/lib/auth.ts`
- Root route: `apps/web/src/routes/__root.tsx`
- Auth guard: `apps/web/src/routes/_authenticated.tsx`
